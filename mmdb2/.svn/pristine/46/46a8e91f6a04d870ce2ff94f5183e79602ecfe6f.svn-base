package com.mmdb.mongo;

import java.io.FileOutputStream;
import java.io.InputStream;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.Statement;

import com.mongodb.gridfs.GridFSDBFile;
import com.mmdb.mongo.mongodb.jdbc.MongoResultSet;
import com.mmdb.mongo.mongodb.jdbc.MongoStatement;
import com.mmdb.util.HexString;

public class Client {

	public static void main(String[] args) throws Exception {
		Class.forName("com.mmdb.mongo.mongodb.jdbc.MongoDriver");
		Connection c = DriverManager.getConnection("mongodb://localhost:40003/test");
	/*	String s = "localhost:40000,localhost:30000,localhost:40001/test";
		String[] strs = s.split("/");
		String[] adds = strs[0].split(",");
		for(String add : adds){
			String[] ad = add.split(":");
			System.out.println(ad[0] + "asdasd"+ ad[1]);
		}*/
		
		/*PreparedStatement ps = c.prepareStatement("insert into tbl(id,name,path) values ( ? , ? , ? )" );
		for(int i = 0; i<100;i++){
			ps.setInt(1, i+10);
			ps.setString(2, "name"+i);
			ps.setString(3, "path"+i);
			ps.executeUpdate();
			//ps.addBatch();
		}*/
		//ps.executeBatch();
		
		//String sql = "select * from users where ((country='Chi8' or country='Chi9' or country='Chi18' or country='Chi19' or country='Chi28' or country='Chi19') and name like 'ong' or age < 19) and age >15";
		
		//String sql = "select * from Performance where `ciCategoryId` = '55b07b3cb6c11f6aaf3d9e7c' and `ciId` = '55b07bb1b6c11f6aaf3d9e80' and `kpiCategoryId` = '55afc835b6c1ec9d0e801f90' and `kpiId` = '55afc85fb6c1ec9d0e801f91' and `time` >= 1439083569000 and `time` <=1439169969000  order by ciHex,kpiHex,time desc limit 0,1000";
		
		String sql = "select * from Ci";
		MongoStatement stmt = (MongoStatement) c.createStatement();
		//stmt.executeUpdate("delete from Ci");
		int count = stmt.executeQueryCount(sql);
		System.out.println(count);

	}

}
